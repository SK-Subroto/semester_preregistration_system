
{% extends 'base.html' %}
{% block body %}

{% load static %}
<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Final Registration</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
</head>
<body>
     <div class="card">
        <div class="header bg-green">
            <h2 style="text-align: center">

               Pre-registered Sudent List <small><span class=". . . . ."></span></small>

            </h2>
            <a style="float: left; margin-top: -30px" type="button" id="submitbtn"  class="btn bg-red waves-effect btn-lg  cregister" href="/teacher/"><< Back to Home</a>
            <ul class="header-dropdown m-r--5">
                <li class="dropdown">
                    <a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                        <i class="material-icons">more_vert</i>
                    </a>
                    <ul class="dropdown-menu pull-right">
                        <li><a href="javascript:void(0);">Action</a></li>
                        <li><a href="javascript:void(0);">Another action</a></li>
                        <li><a href="javascript:void(0);">Something else here</a></li>
                    </ul>
                </li>
            </ul>
        </div>
        <div class="body">
            {#        course table start#}
            <div class="row clearfix">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <div class="table-responsive" style="height: 600px; overflow-y: scroll">
                        <table class="table table-bordered table-striped table-hover dataTable js-exportable">
                            <thead>
                                <tr style="vertical-align: middle">
                                    <th style="width: 3%;">SL</th>
                                    <th style="width: 10%">Student ID</th>
                                    <th style="width: 10%">Student Name</th>
                                    <th style="width: 10%">Student Email</th>
                                    <th style="width: 10%">Student Phone</th>
                                    <th style="width: 30%">Courses</th>
                                    <th style="width: 15%">Remark</th>
                                    <th style="width: 7%"></th>
                                </tr>
                            </thead>

                            <tbody>
                            {% for student in sdetails %}
                                 <tr >
                                   <th scope="row" style="width: 3%;">{{ forloop.counter }}</th>
                                   <td style="width: 10%;" id="p{{ student.student__stID }}"><p ><b>{{ student.student__stID }}</b></p></td>
                                    <td style="text-align: left;width:10%;">{{ student.student__stName }}</td>
                                   <td style="width: 10%;">{{ student.student__stEmail }}</td>
                                   <td style="width: 10%;">{{ student.student__stPhone }}</td>
                                   <td style="width: 30%;">
                                       {% for course in cdetails %}
                                           {% if course.student__stID == student.student__stID %}
                                            <b>{{ course.course__courseCode }}</b>--({{ course.course__courseTitle }})--<b>{{ course.section }}</b><br>
                                           {% endif %}
                                       {% endfor %}
                                   </td>
                                       <td style="width: 15%"><textarea readonly id="{{ student.student_id }}txt"  style="height: 100%; width: 100%; border-color: Transparent;" contenteditable="true">{{ student.student__remarks__remark }}</textarea></td>
                                         <td style="width: 5%; align-content: center;">
                                         <button   id="{{ student.student__stID }}" class="register"  type="button" data-toggle="tooltip" data-original-title="Registration Status" data-placement="top">
                                            <i id="i{{ student.student__stID }}" class="material-icons"></i>
                                        </button>
                                             <input type="hidden" id="h{{ student.student__stID  }}" />
{#                                             {% for status in status %}#}
{#                                                 {% if status.student__stID==student.student__stID %}#}
{#                                                    {% if status.registered %}#}
{#                                                       <button id="{{ student.student__stID }}" disabled  class="btn bg-red waves-effect" type="button" data-toggle="tooltip" data-original-title="Go to student portal" data-placement="top">#}
{#                                                            <i class="material-icons">done</i>#}
{#                                                        </button>#}
{#                                                 {% else %}#}
{#                                                    <button id="{{ student.student__stID }}"  class="btn bg-teal waves-effect" type="button" data-toggle="tooltip" data-original-title="Go to student portal" data-placement="top">#}
{#                                                            <i class="material-icons">input</i>#}
{#                                                        </button>#}
{#                                                 {% endif %}#}
{#                                                 {% endif %}#}
{#                                                 {% endfor %}#}
                                   </td>
                                 </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

<script type="text/javascript">
 $(document).ready(function() {
     var semester = '201';
    req = $.ajax({
        url: '/teacher/findregstatus/',
        type: 'POST',
        data: {
            semester: semester,
        },
    });
    req.done(function(data) {
        var x;
        var studentstatus = JSON.parse(data);
        for (x in studentstatus) {
            var status = studentstatus[x];
            var btnid = status.student__stID;
            try {
                if (status.registered) {
                    console.log(btnid);
                    document.getElementById('i' + btnid).innerHTML = 'done';
                    document.getElementById('p' + btnid).style.backgroundColor = 'teal';
                    document.getElementById('p' + btnid).style.color = 'white';
                    $("#" + btnid).toggleClass("btn bg-red waves-effect register");
                    {#$("#" + btnid).prop("disabled", true);#}
                    document.getElementById('h' + btnid).value = 'true';
                }
                else {
                    document.getElementById('h' + btnid).value = 'false';
                    $("#" + btnid).toggleClass("btn bg-red waves-effect register");
                    document.getElementById('i' + btnid).innerHTML = 'input';
                }
            }
            catch (e) {
                console.log(e);
            }
        }

    });
 });

</script>
<script type="text/javascript">
    $(document).ready(function() {
        $('.register').on('click', function(e) {
            var semester = '201';
            var btnid = this.id;
            var regstatus = document.getElementById('h'+btnid).value;
            req = $.ajax({
                        url: '/teacher/changeregstatus/',
                        type: 'POST',
                        data: {
                            semester: semester,
                            sid: btnid,
                            status: regstatus
                        },
                    });
                if(regstatus == 'true'){
                    {#$("#"+btnid).toggleClass("");#}
                    {#$("#"+btnid).toggleClass(" bg-red");#}
                    document.getElementById('i'+btnid).innerHTML = 'input';
                    {#document.getElementById('p'+btnid).style.backgroundColor= 'teal';#}
                    {#document.getElementById('p'+btnid).style.color= 'white';#}
                    {#$("#"+btnid).prop("disabled", true);#}
                    document.getElementById('h' + btnid).value = 'false';
                    document.getElementById('p'+btnid).style.backgroundColor = "red";
                }
                else
                    document.getElementById('i'+btnid).innerHTML = 'done';
                    {#$("#"+btnid).toggleClass("btn bg-teal waves-effect register");#}
                    document.getElementById('p'+btnid).style.backgroundColor= 'teal';
                    document.getElementById('p'+btnid).style.color= 'white';
                    document.getElementById('h' + btnid).value = 'true';
        });
    });
</script>
</body>
</html>

{% endblock %}